<div class="container mx-auto p-4">
  <div class="bg-white rounded-lg shadow p-4">
    <h1 class="text-3xl font-semibold"><%= @user.username %></h1>
    <div class="mt-4">
      <% if @user.profile_picture.present? %>
        <img src="<%= @user.profile_picture %>" alt="<%= @user.username %>'s profile picture" class="rounded-full w-32 h-32">
      <% else %>
        <div class="rounded-full bg-gray-200 w-32 h-32 flex items-center justify-center">
          <span class="text-gray-700 text-lg">No Image</span>
        </div>
      <% end %>
    </div>
    <div class="mt-4">
      <p class="text-gray-700"><%= @user.bio %></p>
    </div>
  </div>


    <div id="profile-info" class="tab-content mt-4">
      <h2 class="text-2xl font-semibold">Profile Information</h2>
      <p class="text-gray-700"><%= @user.bio %></p>
    </div>

    <div id="posts" class="tab-content mt-4 hidden">
      <h2 class="text-2xl font-semibold">Posts</h2>
      <%= link_to 'New Post', new_post_path, class: 'btn btn-primary' %>
      <% @posts.each do |post| %>
        <div class="bg-white rounded-lg shadow p-4 mt-4">
          <h3 class="text-xl font-semibold"><%= post.title %></h3>
          <p class="text-gray-700"><%= post.created_at.strftime("%B %d, %Y") %></p>
          <div class="mt-2">
            
            <% if post.post_type == 'article' %>
              <p><%= post.body %></p>
            <% elsif post.post_type == 'video' %>
              <a href="<%= post.url %>" class="text-blue-500">Watch Video</a>
            <% elsif post.post_type == 'trade_idea' %>
              <% if post.trade.present? %>
                <div>
                  <p><strong>Stock Name:</strong> <%= post.trade.stock_name %></p>
                  <p><strong>Executed At:</strong> <%= post.trade.executed_at.strftime("%B %d, %Y %H:%M") %></p>
                  <p><strong>Performance:</strong> <%= post.trade.performance %></p>
                  <p><strong>Buy or Sell:</strong> <%= post.trade.buy_or_sell %></p>
                  <p><strong>Quantity:</strong> <%= post.trade.quantity %></p>
                  <p><strong>Price:</strong> <%= post.trade.price %></p>
                  <p><strong>Description:</strong> <%= post.trade.description %></p>
                </div>
              <% else %>
                <p>No trade details available.</p>
              <% end %>
            <% end %>
            <% if current_user == post.user %>
              <%= link_to 'Edit', edit_post_path(post), class: 'btn btn-primary' %>
            <% else %>
              <p>The current user does not own this post.</p>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div id="subscriptions" class="tab-content mt-4 hidden">
      <h2 class="text-2xl font-semibold">Subscriptions</h2>
      <% if @subscriptions.any? %>
        <% @subscriptions.each do |subscription| %>
          <div class="bg-white rounded-lg shadow p-4 mt-4">
            <h3 class="text-xl font-semibold"><%= subscription.trader.username %></h3>
            <p class="text-gray-700"><%= subscription.trader.bio %></p>
          </div>
        <% end %>
      <% else %>
        <p class="text-gray-700">You aren't subscribed to any creators yet.</p>
      <% end %>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const tabs = document.querySelectorAll('.tab-content');
    const links = document.querySelectorAll('ul li a');

    links.forEach(link => {
      link.addEventListener('click', function(event) {
        event.preventDefault();
        tabs.forEach(tab => tab.classList.add('hidden'));
        const target = document.querySelector(link.getAttribute('href'));
        target.classList.remove('hidden');
        links.forEach(link => link.classList.remove('bg-gray-200'));
        link.classList.add('bg-gray-200');
      });
    });
  });
</script>
